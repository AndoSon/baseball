<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Baseball.Rankings</title>

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="css/bootstrap.min.css" type="text/css">

    <!-- Custom Fonts -->
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Merriweather:400,300,300italic,400italic,700,700italic,900,900italic' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="font-awesome/css/font-awesome.min.css" type="text/css">

    <!-- Plugin CSS -->
    <link rel="stylesheet" href="css/animate.min.css" type="text/css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/creative.css" type="text/css">

    <link rel="stylesheet" href="http://code.jquery.com/ui/1.8.18/themes/base/jquery-ui.css" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body id="page-top">

    <nav id="mainNav" class="navbar navbar-default navbar-fixed-top">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand page-scroll" href="#page-top">Go to top</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a class="page-scroll" href="#about">About</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="#services">Services</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="#algorithms">Algorithms</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="#contact">Contact</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container-fluid -->
    </nav>

    <header>
        <div class="header-content">
            <div class="header-content-inner">
                <h1>Baseball.Rankings</h1>
                <hr>
                <p>다양한 알고리즘을 통해 KBO랭킹 데이터를 실시간으로 확인하세요!</p>
                <a href="#about" class="btn btn-primary btn-xl page-scroll">더 알아보기</a>
            </div>
        </div>
    </header>

    <section class="bg-primary" id="about">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 text-center">
                    <h2 class="section-heading">다양한 알고리즘, 다양한 순위</h2>
                    <hr class="light">
                    <p class="text-faded">현재 KBO 랭킹은 단순히 승률로만 순위가 결정 됩니다.</br>
                        하지만 승률만으로는 상대적인 전적을 알아보기에는 부족합니다.</br>
                        따라서 사용자가 원하는 알고리즘에 따라 다양한 순위 및 데이터를 제공하여, </br>
                        스포츠 데이터 분석에 효과적으로 사용할 수 있습니다. </p>
                </div>
            </div>
        </div>
    </section>

    <section id="services">

        <div class="container">
            <div class="row">
                
                <div class="col-lg-12 text-center">
                    <div class="service-box">
                        

                        <h2>날짜를 선택해 주세요</h2>
                        <div class="picker-css">
                            <span class="glyphicon glyphicon-calendar" aria-hidden="true"></span>
                            <span>
                                <input type="text" id="testDatepicker">
                            </span>
                            
                        </div>

                        <h4 id="test-text"> 2012 ~ 2014 시즌만 선택 가능합니다.</h4>
                                                
                        <button id= "start-button" class="btn btn-primary btn-xl" type="submit">시작</button>

                    </div>
                </div>
            </div>
        </div>

    </section>




    <section class="no-padding" id="algorithms">
        <div class="container-fluid">
            <div class="row no-gutter">
                <div class="col-md-12 text-center">
                    <h2> KBO 랭킹</h2>
                     <div class="col-md-6">
                        <table id = "tableOne"class = "table table-bordered table-striped"></table>
                    </div>
                    <div id="chart_div" class="col-md-6">
                       chart1
                    </div>
                </div>
                <div class="col-md-12 text-center">
                    <h2> Page rank (d=0.8)</h2>
                     <div class="col-md-6">
                        <table id = "tableTwo"class = "table table-bordered table-striped"></table>
                    </div>
                    <div class="col-md-6">
                       chart2
                    </div>
                </div>
                <div class="col-md-12 text-center">
                    <h2> Page rank (d=1.0)</h2>
                     <div class="col-md-6">
                        <table id = "tableThree"class = "table table-bordered table-striped"></table>
                    </div>
                    <div class="col-md-6">
                       chart3
                    </div>
                </div>
                <div class="col-md-12 text-center">
                    <h2> Bradley Terry</h2>
                     <div class="col-md-6">
                        <table id = "tableFour"class = "table table-bordered table-striped"></table>
                    </div>
                    <div class="col-md-6">
                       chart4
                    </div>
                </div>
               
                
            </div>
        </div>
    </section>

    <section id="contact" class="bg-primary">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 text-center">
                    <h2 class="section-heading">Let's Get In Touch!</h2>
                    <hr class="primary">
                    <p>이 웹페이지의 HTML, CSS는 Twiter Bootstrap Free Themes에서 다운 받았습니다.</br>
                        개선사항이나 피드백이 있으면 연락바랍니다.</p>
                </div>
                <div class="col-lg-4 col-lg-offset-2 text-center">
                    <i class="fa fa-phone fa-3x wow bounceIn"></i>
                    <p>010-8932-xxxx</p>
                </div>
                <div class="col-lg-4 text-center">
                    <i class="fa fa-envelope-o fa-3x wow bounceIn" data-wow-delay=".1s"></i>
                    <p><a href="mailto:idycon90@gmail.com">idycon90@gmail.com</a></p>
                </div>
            </div>
        </div>
    </section>

    <!-- jQuery -->
    <script src="js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="js/bootstrap.min.js"></script>

    <!-- Plugin JavaScript -->
    <script src="js/jquery.easing.min.js"></script>
    <script src="js/jquery.fittext.js"></script>
    <script src="js/wow.min.js"></script>

    <!-- Custom Theme JavaScript -->
    <script src="js/creative.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="http://code.jquery.com/ui/1.8.18/jquery-ui.min.js"></script>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>

    <script type="text/javascript">


    // Load the Visualization API and the piechart package.
    // Load the Visualization API and the piechart package.
    google.load('visualization', '1.0', {'packages':['corechart']});


    // Set a callback to run when the Google Visualization API is loaded.

    function drawChart(jsonData) {

        // Create the data table.


        var data = new google.visualization.DataTable();
        data.addColumn('string', 'TeamName');
        data.addColumn('number', 'Value');

        var rows = Array();
        var j=0;

        for(var i=0; i<jsonData.length; i++)
        {
            if(jsonData[i][5] != 0)
            {
                rows[j] = new Array(2);
                rows[j][0] = jsonData[i][0];
                rows[j][1] = jsonData[i][5];
                j++;
                //console.log(rows);
            }                
        }

        data.addRows(rows);
        

        // Set chart options
        var options = {'title':'전적 표',
                       'width':500,
                       'height':500};

        // Instantiate and draw our chart, passing in some options.
        var chart = new google.visualization.PieChart(document.getElementById('chart_div'));
        chart.draw(data, options);
    };

    
    

    $("#start-button").click( function() {

        var rankingArray = ["ranking"];



        var date = $("#testDatepicker").val();
        $("#test-text").text(date);

        var ajaxOne = $.ajax({
            url:'./data.php',
            type:'post',
            data: { name : date },
            dataType: "json",

        });



        ajaxOne.done(function( data ) {
            var elem = "<thead><tr><th>순위</th><th>팀명</th><th>승</th><th>패</th><th>무</th><th>경기 수</th><th>승률</th></tr></thead><tbody>";
            for(var i in data){
                var item = data[i];
                if(item[4]!=0)
                    {
                        elem += "<tr><td>"+ (parseInt(i)+1) + "</td><td>" +item[0] +"</td><td>"+ item[1]
                         + "</td><td>"+ item[2]
                         + "</td><td>"+ item[3]
                         + "</td><td>"+ item[4]
                         + "</td><td>"+ Math.floor(item[5]*1000)/1000
                         + "</td></tr>";

                         rankingArray.push(item[0]);
                     }
                 }
                 elem += "</tbody>";
                 $('#tableOne').html(elem);

                 drawChart(data);
                 console.log(rankingArray);



             });

        //ajaxOne finished

        var ajaxTwo = $.ajax({
            url:'./data2.php',
            type:'post',
            data: { name : date }            
        });

        ajaxTwo.done(function( data ) {
            var elem = "<thead><tr><th>순위</th><th>팀명</th><th>PR</th><th>순위 변동</th></tr></thead><tbody>";
            for(var i in data){
              var item = data[i];

              {
                elem += "<tr><td>"+ (parseInt(i)+1) + "</td><td>" + item[0] +"</td><td>"+ item[1]+ 
                "</td><td>"+ (rankingArray.indexOf(item[0]) - (parseInt(i)+1) )+"</td></tr>";
              }

            }
            elem += "</tbody>";
            $('#tableTwo').html(elem);

        });

        //ajaxTwo finished

        var ajaxThree = $.ajax({
            url:'./data3.php',
            type:'post',
            data: { name : date }            
        });

        ajaxThree.done(function( data ) {

            // console.log(data);
            var elem = "<thead><tr><th>순위</th><th>팀명</th><th>PR</th><th>순위 변동</th></tr></thead><tbody>";
            for(var i in data){
              var item = data[i];
              {
                elem += "<tr><td>"+ (parseInt(i)+1) + "</td><td>" + item[0] +"</td><td>"+ item[1]+ 
                "</td><td>"+ (rankingArray.indexOf(item[0]) - (parseInt(i)+1) )+"</td></tr>";
              }

            }
            elem += "</tbody>";
            $("#tableThree").html(elem);
        });

        //ajaxThree finished

        var ajaxFour = $.ajax({
            url:'./data4.php',
            type:'post',
            data: { name : date }            
        });

        ajaxFour.done(function( data ) {

            // console.log(data);

            var elem = "<thead><tr><th>순위</th><th>팀명</th><th>PR</th><th>순위 변동</th></tr></thead><tbody>";
            for(var i in data){
              var item = data[i];
              {
                elem += "<tr><td>"+ (parseInt(i)+1) + "</td><td>" + item[0] +"</td><td>"+ item[1]+ 
                "</td><td>"+ (rankingArray.indexOf(item[0]) - (parseInt(i)+1) )+"</td></tr>";
              }

            }
            elem += "</tbody>";

            $("#tableFour").html(elem);
            
        });

        //ajaxFour finished


    }); //end of click event

    $(function() {
        $( "#testDatepicker" ).datepicker({
            changeMonth: true,
            changeYear: true,
            dateFormat: "yy-mm-dd",
            yearRange: '2012:2015',
            maxDate: -1,
        });
    });

    </script>

</body>

</html>
